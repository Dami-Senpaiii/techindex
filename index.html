<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TechIndex – Schweizer Tech‑Blog für Hardware, Software, Fotografie & Preisvergleiche</title>
  <meta name="description" content="TechIndex ist ein unabhängiger Schweizer Tech‑Blog. Deep Dives zu Hardware & Software, Kamera‑Guides und transparente Preisvergleiche.">
  <meta name="theme-color" content="#0a0a0a">
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="TechIndex – Schweizer Tech‑Blog">
  <meta property="og:description" content="Hardware, Software, Fotografie, Preisvergleiche – kompakt & fundiert.">
  <meta property="og:url" content="https://techindex.ch/">
  <style>
    :root{
      --bg:#0a0a0a;          /* dunkles Layout wie NVIDIA Dev Blog */
      --panel:#121212;
      --muted:#a1a1a1;
      --text:#fff;
      --border:#1f1f1f;
      --accent:#76B900;      /* NVIDIA‑grün als Akzent */
      --accent-weak:#5e9400;
      --radius:16px;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --max:1120px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,"Helvetica Neue",Arial}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{max-width:var(--max);padding:0 20px;margin:0 auto}
    /* Nav */
    .nav{position:sticky;top:0;z-index:50;background:rgba(0,0,0,.7);backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
    .brand{display:flex;gap:10px;align-items:center;font-weight:700}
    .brand-badge{width:28px;height:28px;border:2px solid var(--accent);border-radius:8px;display:grid;place-items:center}
    .brand-badge svg{stroke:var(--accent)}
    .menu{display:flex;gap:18px;align-items:center}
    .menu a{color:#eaeaea;font-size:.95rem;opacity:.85}
    .menu a:hover{opacity:1}
    .menu .cta{margin-left:12px;opacity:1;color:#000;background:var(--accent);border:none}
    .menu .cta:hover{background:var(--accent);filter:brightness(1.05)}
    .cta{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);padding:8px 12px;border-radius:12px}
    .cta:hover{background:#101010}
    .mobile-nav-toggle{display:none;border:1px solid var(--border);background:#0d0d0d;color:#fff;padding:8px 10px;border-radius:12px;align-items:center;gap:8px;font-weight:600;cursor:pointer}
    .mobile-nav-toggle .icon-bars{display:block;width:18px;height:2px;background:var(--accent);position:relative;border-radius:999px}
    .mobile-nav-toggle .icon-bars::before,.mobile-nav-toggle .icon-bars::after{content:"";position:absolute;left:0;width:100%;height:100%;background:var(--accent);border-radius:999px;transition:transform .2s ease}
    .mobile-nav-toggle .icon-bars::before{top:-6px}
    .mobile-nav-toggle .icon-bars::after{top:6px}
    .mobile-nav-toggle[aria-expanded="true"] .icon-bars{background:transparent}
    .mobile-nav-toggle[aria-expanded="true"] .icon-bars::before{transform:translateY(6px) rotate(45deg)}
    .mobile-nav-toggle[aria-expanded="true"] .icon-bars::after{transform:translateY(-6px) rotate(-45deg)}
    body.nav-open{overflow:hidden}
    body.nav-open::after{content:"";position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:40}

    /* Hero */
    .hero{position:relative;isolation:isolate}
    .hero::before{content:"";position:absolute;inset:-20% -20% auto -20%;height:420px;background:radial-gradient(900px 380px at 50% -10%, rgba(118,185,0,.28), transparent)}
    .hero-inner{padding:56px 0}
    .h1{font-size:clamp(28px,3.4vw,48px);line-height:1.15;margin:0 0 10px;font-weight:850;letter-spacing:-.01em}
    .lead{color:#d6ffd6;max-width:760px}
    .hero-actions{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap}
    .btn{border:none;background:var(--accent);color:#000;font-weight:700;padding:12px 16px;border-radius:12px;box-shadow:var(--shadow);cursor:pointer}
    .btn.outline{background:transparent;color:#fff;border:1px solid var(--border);box-shadow:none}
    .btn:hover{filter:brightness(1.05)}
    .btn:disabled,.btn[disabled]{opacity:.55;cursor:not-allowed;box-shadow:none;filter:none}

    /* Featured */
    .grid{display:grid;gap:16px}
    .grid-3{grid-template-columns:repeat(3,1fr)}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;display:block;transition:border-color .18s ease,transform .18s ease}
    .card a{display:block;color:inherit;height:100%}
    .card a:focus-visible{outline:2px solid var(--accent);outline-offset:3px}
    .card:hover{border-color:var(--accent);transform:translateY(-3px)}
    .card .thumb{aspect-ratio:16/9;background:#0f0f0f;overflow:hidden}
    .card .body{padding:16px}
    .tag{display:inline-block;padding:4px 8px;border:1px solid var(--border);border-radius:999px;color:#eee;font-size:12px;opacity:.85}
    .title{margin:6px 0 6px;font-weight:750;font-size:1.15rem}
    .muted{color:var(--muted)}

    /* Sections */
    section{padding:28px 0}
    .section-head{display:flex;align-items:end;justify-content:space-between;gap:16px;margin-bottom:8px}
    h2{margin:0;font-size:clamp(20px,2.4vw,28px)}

    /* Latest + filter */
    .filters{display:flex;gap:10px;flex-wrap:wrap}
    .pill{border:1px solid var(--border);padding:6px 10px;border-radius:999px;background:#0b0b0b;color:#eee;cursor:pointer;font-size:.92rem}
    .pill.active, .pill:hover{border-color:var(--accent);color:#fff}
    .search{flex:1;min-width:240px}
    .search input{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#0b0b0b;color:#fff}

    /* Price index teaser */
    .price-table{width:100%;border-collapse:collapse;font-size:.95rem}
    .price-table th,.price-table td{border-bottom:1px solid var(--border);padding:10px 8px;text-align:left}
    .price-table tr:hover{background:#101010}

    /* Newsletter */
    .newsletter{background:linear-gradient(120deg, rgba(118,185,0,.18), transparent);border:1px solid var(--border);border-radius:var(--radius);padding:18px}
    .newsletter form{display:flex;gap:10px;flex-wrap:wrap}
    .newsletter input{flex:1;min-width:220px;padding:12px;border-radius:12px;border:1px solid var(--border);background:#0b0b0b;color:#fff}

    /* Footer */
    footer{border-top:1px solid var(--border)}
    .cols{display:grid;gap:18px;grid-template-columns:repeat(4,1fr)}
    .small{font-size:.9rem}

    /* Responsive */
    @media (max-width: 960px){
      .grid-3{grid-template-columns:1fr 1fr}
      .cols{grid-template-columns:1fr 1fr}
    }
    @media (max-width: 640px){
      .mobile-nav-toggle{display:inline-flex}
      .menu{display:none;position:fixed;top:68px;right:20px;left:20px;background:#101010;border:1px solid var(--border);border-radius:var(--radius);padding:20px;flex-direction:column;gap:12px;box-shadow:var(--shadow);z-index:70}
      .menu.open{display:flex}
      .menu a{font-size:1rem;opacity:1;padding:4px 0}
      .menu .cta{justify-content:center;margin-left:0}
      .grid-3{grid-template-columns:1fr}
      .cols{grid-template-columns:1fr}
      .hero-inner{padding:40px 0}
    }
  </style>
</head>
<body>
  <!-- NAVIGATION -->
  <nav class="nav">
    <div class="container nav-inner">
      <a href="#" class="brand" aria-label="TechIndex Startseite">
        <span class="brand-badge" aria-hidden="true">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke-width="2">
            <rect x="2" y="2" width="20" height="20" rx="4" ry="4"/>
            <path d="M7 16l5-8 5 8" fill="none"/>
          </svg>
        </span>
        <span>TechIndex</span>
      </a>
      <button class="mobile-nav-toggle" id="nav-toggle" type="button" aria-expanded="false" aria-controls="menu" aria-label="Menü öffnen">
        <span class="icon-bars" aria-hidden="true"></span>
        <span class="visually-hidden">Menü</span>
      </button>
      <div class="menu" role="navigation" aria-label="Hauptmenü" id="menu">
        <a href="#neuste">Neuste Beiträge</a>
        <a href="#hardware">Hardware</a>
        <a href="#software">Software</a>
        <a href="#fotografie">Fotografie</a>
        <a href="#preisindex">Preisindex</a>
        <a href="#newsletter">Newsletter</a>
        <a href="about.html">Über uns</a>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <header class="hero">
    <div class="container hero-inner">
      <h1 class="h1">Das Schweizer Tech‑Magazin für Builder</h1>
      <p class="lead">Fundierte Artikel zu <strong>Hardware</strong>, <strong>Software</strong> & <strong>Fotografie</strong> – plus transparente <strong>Preisvergleiche</strong> für smarte Kaufentscheide. Kein Fluff, nur Signal.</p>
      <div class="hero-actions">
        <a class="btn" href="#neuste">Jetzt lesen</a>
        <a class="btn outline" href="#newsletter">Newsletter abonnieren</a>
      </div>
    </div>
  </header>

  <!-- FEATURED -->
  <section id="featured">
    <div class="container">
      <div class="section-head">
        <h2>Empfehlungen der Redaktion</h2>
        <a class="small" href="#neuste" style="color:var(--accent)">Alle Beiträge →</a>
      </div>
      <div class="grid grid-3">
        <!-- Card 1 -->
        <article class="card">
          <a href="articles/linux-auf-dem-mini-pc-setup-und-tuning.html">
            <div class="thumb"><img src="https://picsum.photos/seed/linux-auf-dem-mini-pc-setup-und-tuning/480/270" alt="Mini-PC mit geöffnetem Gehäuse und Linux-Terminal"></div>
            <div class="body">
              <span class="tag">Hardware</span>
              <h3 class="title">Linux auf dem Mini‑PC: Setup &amp; Tuning</h3>
              <p class="muted">BIOS, Kernel-Tweaks und Undervolting – so wird dein SFF-System leiser und effizienter.</p>
            </div>
          </a>
        </article>
        <!-- Card 2 -->
        <article class="card">
          <a href="articles/self-hosted-preis-tracker-mit-docker.html">
            <div class="thumb"><img src="https://picsum.photos/seed/self-hosted-preis-tracker-mit-docker/480/270" alt="Server-Rack mit Docker-Logos und Preisdiagramm"></div>
            <div class="body">
              <span class="tag">Software</span>
              <h3 class="title">Self‑Hosted Preis‑Tracker mit Docker</h3>
              <p class="muted">Scrapy, PostgreSQL und Prometheus bauen dir Preisalarme ohne externe APIs.</p>
            </div>
          </a>
        </article>
        <!-- Card 3 -->
        <article class="card">
          <a href="articles/street-photography-7-praxis-tipps.html">
            <div class="thumb"><img src="https://picsum.photos/seed/street-photography-7-praxis-tipps/480/270" alt="Menschen im Gegenlicht einer Stadtstrasse"></div>
            <div class="body">
              <span class="tag">Fotografie</span>
              <h3 class="title">Street‑Photography: 7 Praxis‑Tipps</h3>
              <p class="muted">Timing, Zonofokus und Layering – unsere Feldnotizen für bessere Strassenszenen.</p>
            </div>
          </a>
        </article>
      </div>
    </div>
  </section>

  <!-- LATEST / FILTERS -->
  <section id="neuste">
    <div class="container">
      <div class="section-head">
        <h2>Neuste Beiträge</h2>
        <div class="search"><label class="visually-hidden" for="q">Suche</label><input id="q" type="search" placeholder="Suche nach Themen oder Titeln…"></div>
      </div>
      <div class="filters" id="tagbar" aria-label="Themenfilter">
        <button class="pill active" data-tag="">Alle</button>
        <button class="pill" data-tag="Hardware">Hardware</button>
        <button class="pill" data-tag="Software">Software</button>
        <button class="pill" data-tag="Fotografie">Fotografie</button>
        <button class="pill" data-tag="Preisvergleich">Preisvergleich</button>
      </div>

      <div class="grid grid-3" id="posts" style="margin-top:16px"></div>
      <div class="section-head" style="margin-top:10px">
        <small class="muted" id="count">Seite 1</small>
        <div>
          <button class="pill" id="prev">Zurück</button>
          <button class="pill" id="next">Weiter</button>
        </div>
      </div>
    </div>
  </section>

  <!-- PRICE INDEX TEASER -->
  <section id="preisindex">
    <div class="container">
      <div class="section-head">
        <h2>Preisindex (Preview)</h2>
        <a class="small" href="#" style="color:var(--accent)">Zu allen Vergleichen →</a>
      </div>
      <div class="card" style="padding:12px">
        <table class="price-table" aria-describedby="preisindex">
          <thead>
            <tr><th>Produkt</th><th>Beste Preise ab</th><th>Tendenz</th></tr>
          </thead>
          <tbody>
            <tr><td>NVMe SSD 2TB (PCIe 4.0)</td><td>CHF 89.–</td><td><span style="color:var(--accent)">↘︎ fallend</span></td></tr>
            <tr><td>Spiegellose Kamera (APS‑C)</td><td>CHF 699.–</td><td>→ stabil</td></tr>
            <tr><td>Wi‑Fi 6E Router</td><td>CHF 149.–</td><td>→ stabil</td></tr>
            <tr><td>32" 4K Monitor (IPS)</td><td>CHF 279.–</td><td><span style="color:var(--accent)">↘︎ fallend</span></td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- NEWSLETTER -->
  <section id="newsletter">
    <div class="container newsletter">
      <div class="section-head">
        <h2>TechIndex Weekly</h2>
        <small class="muted">Einmal pro Woche. Keine Werbung, nur Mehrwert.</small>
      </div>
      <form id="newsletter-form" novalidate>
        <label for="email" class="visually-hidden">E‑Mail</label>
        <input id="email" name="email" type="email" placeholder="dein@email.ch" autocomplete="email" required>
        <button class="btn" type="submit">Abonnieren</button>
        <button class="btn outline" type="button" id="newsletter-export" disabled>CSV exportieren</button>
      </form>
      <p class="small" id="newsletter-status" role="status" aria-live="polite" style="margin-top:10px;color:var(--muted)"></p>
    </div>
  </section>

  <!-- FOOTER -->
  <footer id="about">
    <div class="container" style="padding:20px 0 28px">
      <div class="cols">
        <div>
          <div class="brand" style="margin-bottom:8px">
            <span class="brand-badge" aria-hidden="true"></span>
            <strong>TechIndex</strong>
          </div>
          <p class="muted small">TechIndex ist ein unabhängiger Blog aus der Schweiz. Fokus: Tech, Tools & Taktiken zum Bauen – plus nüchterne Preisvergleiche.</p>
        </div>
        <div>
          <strong>Ressourcen</strong>
          <ul class="small" style="list-style:none;padding:0;margin:8px 0 0">
            <li><a href="#">RSS</a></li>
            <li><a href="#">Styleguide</a></li>
            <li><a href="#">Advertise</a></li>
          </ul>
        </div>
        <div>
          <strong>Themen</strong>
          <ul class="small" style="list-style:none;padding:0;margin:8px 0 0">
            <li><a href="#hardware">Hardware</a></li>
            <li><a href="#software">Software</a></li>
            <li><a href="#fotografie">Fotografie</a></li>
            <li><a href="#preisindex">Preisvergleiche</a></li>
          </ul>
        </div>
        <div>
          <strong>Rechtliches</strong>
          <ul class="small" style="list-style:none;padding:0;margin:8px 0 0">
            <li><a href="#">Impressum</a></li>
            <li><a href="#">Datenschutz</a></li>
            <li><a href="#">Kontakt</a></li>
          </ul>
        </div>
      </div>
      <div class="muted small" style="margin-top:14px">© <span id="y"></span> TechIndex.ch — Hosted on Cloudflare.</div>
    </div>
  </footer>

  <script>
    // ----- Demo‑Daten (würden später aus CMS/API kommen)
    const BASE_POSTS = [
      {
        slug: 'langzeit-test-nvme-ssds-2025',
        title: 'Langzeit‑Test: NVMe SSDs 2025',
        tag: 'Hardware',
        excerpt: '12 Monate Belastungstest: Performance-Drift, Temperaturlimits und Firmware-Fallen im Überblick.'
      },
      {
        slug: 'cloud-backup-3-2-1-strategie-einfach-erklaert',
        title: 'Cloud‑Backup: 3‑2‑1‑Strategie einfach erklärt',
        tag: 'Software',
        excerpt: 'So kombinierst du lokale Platten, NAS und verschlüsselte Cloud-Speicher ohne Bauchweh.'
      },
      {
        slug: 'street-photography-7-praxis-tipps',
        title: 'Street‑Photography: 7 Praxis‑Tipps',
        tag: 'Fotografie',
        excerpt: 'Von Zonensystem bis Zonofokus – so gelingen authentische Strassenszenen in jeder Lichtsituation.'
      },
      {
        slug: 'linux-auf-dem-mini-pc-setup-und-tuning',
        title: 'Linux auf dem Mini‑PC: Setup & Tuning',
        tag: 'Hardware',
        excerpt: 'Treiber, Kernel-Parameter und Undervolting: Hol das Maximum aus deinem SFF-System heraus.'
      },
      {
        slug: 'raw-workflow-mit-capture-one-vs-lightroom',
        title: 'RAW‑Workflow mit Capture One vs. Lightroom',
        tag: 'Fotografie',
        excerpt: 'Farb-Engines, Tethering und KI-Masken im direkten Vergleich für Studio und Reportage.'
      },
      {
        slug: 'guenstige-4k-monitore-im-vergleich',
        title: 'Günstige 4K‑Monitore im Vergleich',
        tag: 'Preisvergleich',
        excerpt: 'IPS, VA oder OLED? Wir testen Farbraumabdeckung, Uniformity und Ergonomie unter 500 Franken.'
      },
      {
        slug: 'self-hosted-preis-tracker-mit-docker',
        title: 'Self‑Hosted Preis‑Tracker mit Docker',
        tag: 'Software',
        excerpt: 'Watchtower, Prometheus & Alerts – so automatisierst du Preisalarme komplett in deinem Homelab.'
      },
      {
        slug: 'noise-reduction-topaz-vs-dxo',
        title: 'Noise‑Reduction: Topaz vs. DxO',
        tag: 'Fotografie',
        excerpt: 'KI-Modelle im Direktvergleich: Detailerhalt, Batch-Fähigkeit und GPU-Performance.'
      },
      {
        slug: 'windows-11-privacy-hardening',
        title: 'Windows 11: Privacy Hardening',
        tag: 'Software',
        excerpt: 'Von O&O ShutUp bis Winget-Automation: So reduzierst du Telemetrie auf einem frischen System.'
      }
    ];

    const POSTS = Array.from({length:18}).map((_,i)=>{
      const base = BASE_POSTS[i % BASE_POSTS.length];
      return {
        ...base,
        id: i+1,
        date: new Date(2025,10,(i%28)+1)
      };
    });

    const mobileQuery = window.matchMedia('(max-width: 640px)');
    let perPage = mobileQuery.matches ? 6 : 9; let page=1; let activeTag=''; let q='';
    const postsEl = document.getElementById('posts');
    const countEl = document.getElementById('count');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');
    const navToggle = document.getElementById('nav-toggle');
    const menuEl = document.getElementById('menu');
    const newsletterForm = document.getElementById('newsletter-form');
    const emailInput = document.getElementById('email');
    const newsletterStatus = document.getElementById('newsletter-status');
    const exportBtn = document.getElementById('newsletter-export');
    const NEWSLETTER_KEY = 'techindex.newsletter-subscribers';
    let subscribersCache = [];

    const hasLocalStorage = (()=>{
      try{
        const t='__ti_newsletter__';
        localStorage.setItem(t,'1');
        localStorage.removeItem(t);
        return true;
      }catch(_){
        return false;
      }
    })();

    function loadSubscribers(){
      if(!hasLocalStorage) return [];
      try{
        const raw = localStorage.getItem(NEWSLETTER_KEY);
        if(!raw) return [];
        const parsed = JSON.parse(raw);
        if(!Array.isArray(parsed)) return [];
        return parsed.filter(entry=>entry && typeof entry.email === 'string' && entry.email.trim()).map(entry=>({
          email: entry.email.trim(),
          subscribedAt: entry.subscribedAt || new Date().toISOString()
        }));
      }catch(err){
        console.warn('Newsletter data konnte nicht geladen werden.', err);
        return [];
      }
    }

    function persistSubscribers(entries){
      if(!hasLocalStorage) return;
      try{
        localStorage.setItem(NEWSLETTER_KEY, JSON.stringify(entries));
      }catch(err){
        console.warn('Newsletter data konnte nicht gespeichert werden.', err);
      }
    }

    function setNewsletterStatus(message, tone='info'){
      if(!newsletterStatus) return;
      newsletterStatus.textContent = message;
      let color = 'var(--muted)';
      if(tone === 'error') color = '#ffb4b4';
      if(tone === 'success') color = '#d6ffd6';
      newsletterStatus.style.color = color;
    }

    function updateExportAvailability(){
      if(!exportBtn) return;
      const hasEntries = subscribersCache.length > 0;
      exportBtn.disabled = !hasEntries;
      exportBtn.setAttribute('aria-disabled', hasEntries ? 'false' : 'true');
    }

    function sortSubscribers(){
      subscribersCache.sort((a,b)=>{
        return new Date(b.subscribedAt).getTime() - new Date(a.subscribedAt).getTime();
      });
    }

    function buildCsv(entries){
      const header = 'email,subscribed_at\n';
      const rows = entries.map(entry=>`${entry.email},${entry.subscribedAt}`).join('\n');
      return `${header}${rows}`;
    }

    function triggerCsvDownload(){
      if(!subscribersCache.length){
        setNewsletterStatus('Noch keine Anmeldungen vorhanden.', 'info');
        return;
      }
      const csv = buildCsv(subscribersCache);
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `newsletter-subscribers-${new Date().toISOString().slice(0,10)}.csv`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      setTimeout(()=>URL.revokeObjectURL(url), 1000);
      setNewsletterStatus('CSV-Export gestartet. Datei im Download-Ordner prüfen.', 'success');
    }

    function initNewsletter(){
      if(!newsletterForm || !emailInput){
        return;
      }
      if(!hasLocalStorage){
        setNewsletterStatus('Lokaler Speicher ist deaktiviert – CSV-Speicherung nicht möglich.', 'error');
        if(exportBtn){
          exportBtn.disabled = true;
          exportBtn.setAttribute('aria-disabled', 'true');
        }
        return;
      }

      subscribersCache = loadSubscribers();
      sortSubscribers();
      updateExportAvailability();

      newsletterForm.addEventListener('submit', (event)=>{
        event.preventDefault();
        const emailRaw = (emailInput.value || '').trim();
        emailInput.value = emailRaw;
        if(!emailRaw){
          setNewsletterStatus('Bitte eine E-Mail-Adresse eingeben.', 'error');
          emailInput.focus();
          return;
        }
        if(!emailInput.checkValidity()){ emailInput.reportValidity(); return; }
        const normalizedEmail = emailRaw.toLowerCase();
        const timestamp = new Date().toISOString();
        const existingIndex = subscribersCache.findIndex(entry=>entry.email === normalizedEmail);
        if(existingIndex >= 0){
          subscribersCache[existingIndex] = {
            ...subscribersCache[existingIndex],
            subscribedAt: timestamp
          };
          setNewsletterStatus('E-Mail war bereits eingetragen – Zeitstempel aktualisiert.', 'success');
        }else{
          subscribersCache.push({ email: normalizedEmail, subscribedAt: timestamp });
          setNewsletterStatus('Danke fürs Abonnieren! Eintrag gespeichert.', 'success');
        }
        sortSubscribers();
        persistSubscribers(subscribersCache);
        updateExportAvailability();
        newsletterForm.reset();
        emailInput.focus();
      });

      if(exportBtn){
        exportBtn.addEventListener('click', ()=>{
          triggerCsvDownload();
        });
      }
    }

    function setNav(open){
      if(!navToggle || !menuEl) return;
      navToggle.setAttribute('aria-expanded', open);
      navToggle.setAttribute('aria-label', open ? 'Menü schliessen' : 'Menü öffnen');
      menuEl.classList.toggle('open', open);
      document.body.classList.toggle('nav-open', open);
    }

    if(navToggle && menuEl){
      navToggle.addEventListener('click', ()=>{
        const expanded = navToggle.getAttribute('aria-expanded') === 'true';
        setNav(!expanded);
      });
      menuEl.addEventListener('click', (e)=>{
        if(e.target.closest('a')) setNav(false);
      });
    }

    function render(){
      const filtered = POSTS.filter(p=>(!activeTag||p.tag===activeTag)&&(!q||p.title.toLowerCase().includes(q)));
      const totalPages = Math.max(1, Math.ceil(filtered.length/perPage));
      page = Math.min(page, totalPages);
      const slice = filtered.slice((page-1)*perPage, page*perPage);
      postsEl.innerHTML = slice.map(p=>`
        <a class="card" href="articles/${p.slug}.html">
          <div class="thumb"><img src="https://picsum.photos/seed/${p.slug}/800/450" alt="Vorschaubild" loading="lazy"></div>
          <div class="body">
            <div style="display:flex;justify-content:space-between;align-items:center;font-size:12px;color:#cfcfcf"><span>${p.tag}</span><time datetime="${p.date.toISOString()}">${p.date.toLocaleDateString('de-CH',{day:'2-digit',month:'short',year:'numeric'})}</time></div>
            <h3 class="title">${p.title}</h3>
            <p class="muted">${p.excerpt}</p>
            <span style="display:inline-block;margin-top:8px;color:var(--accent);font-weight:600">Weiterlesen →</span>
          </div>
        </a>`).join('');
      countEl.textContent = `Seite ${page} von ${totalPages}`;
      prevBtn.disabled = page===1;
      nextBtn.disabled = page===totalPages;
    }

    const handleMobileChange = (event)=>{
      const nextPerPage = event.matches ? 6 : 9;
      if(nextPerPage !== perPage){
        perPage = nextPerPage;
        page = 1;
        render();
      }
      if(!event.matches) setNav(false);
    };

    if(mobileQuery.addEventListener){
      mobileQuery.addEventListener('change', handleMobileChange);
    }else if(mobileQuery.addListener){
      mobileQuery.addListener(handleMobileChange);
    }

    document.addEventListener('click', (e)=>{
      if(!menuEl || !navToggle || !menuEl.classList.contains('open')) return;
      if(e.target === navToggle || navToggle.contains(e.target) || menuEl.contains(e.target)) return;
      setNav(false);
    });

    window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') setNav(false); });

    // Filter‑Pills
    document.getElementById('tagbar').addEventListener('click', (e)=>{
      const t = e.target.closest('button.pill'); if(!t) return;
      [...document.querySelectorAll('#tagbar .pill')].forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      activeTag = t.dataset.tag||''; page=1; render();
    });

    // Suche
    document.getElementById('q').addEventListener('input', (e)=>{q=e.target.value.toLowerCase(); page=1; render();});

    // Pagination
    prevBtn.addEventListener('click', ()=>{page=Math.max(1,page-1); render();});
    nextBtn.addEventListener('click', ()=>{page=page+1; render();});

    // Jahr im Footer
    document.getElementById('y').textContent = new Date().getFullYear();

    initNewsletter();
    setNav(false);
    handleMobileChange(mobileQuery);
    render();
  </script>

  <!-- Optional: einfache Accessibility Helferklasse -->
  <style>.visually-hidden{position:absolute !important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}</style>
</body>
</html>
